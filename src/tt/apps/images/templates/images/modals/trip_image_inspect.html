{% extends "modals/action_ok.html" %}
{% load icons %}
{% load tz %}

{% block modal_dialog_class %}tt-modal-dialog-600{% endblock %}

{% block title_text %}
Image Details
{% endblock %}

{% block body %}
{% timezone USER_TIMEZONE %}
<div class="container-fluid p-0">
  <!-- Image Display -->
  <div class="mb-3 text-center">
    {% if image.web_image %}
      <img src="{{ image.web_image.url }}"
           alt="{{ image.caption|default:'Trip Image' }}"
           class="img-fluid rounded"
           style="max-width: 100%; height: auto; max-height: 600px; width: auto;">
    {% else %}
      <div class="text-center text-muted py-5">
        {% icon "camera" size="xl" %}
        <p>No image available</p>
      </div>
    {% endif %}
  </div>

  <!-- Metadata Card -->
  <div class="card">
    <div class="card-header bg-light">
      <strong>Image Information</strong>
    </div>
    <div class="card-body">
      <!-- Caption -->
      {% if image.caption %}
      <div class="row mb-2">
        <div class="col-4 text-muted"><strong>Caption:</strong></div>
        <div class="col-8">{{ image.caption }}</div>
      </div>
      {% endif %}

      <!-- EXIF Date/Time -->
      {% if image.datetime_utc %}
      <div class="row mb-2">
        <div class="col-4 text-muted"><strong>Photo Taken:</strong></div>
        <div class="col-8">{{ image.datetime_utc|date:"F j, Y g:i A" }}</div>
      </div>
      {% endif %}

      <!-- Upload Date/Time -->
      <div class="row mb-2">
        <div class="col-4 text-muted"><strong>Uploaded:</strong></div>
        <div class="col-8">{{ image.uploaded_datetime|date:"F j, Y g:i A" }}</div>
      </div>

      <!-- Uploaded By -->
      {% if image.uploaded_by %}
      <div class="row mb-2">
        <div class="col-4 text-muted"><strong>Uploaded By:</strong></div>
        <div class="col-8">{{ image.uploaded_by.get_full_name|default:image.uploaded_by.email }}</div>
      </div>
      {% endif %}

      <!-- GPS Coordinates -->
      {% if image.latitude and image.longitude %}
      <div class="row mb-2">
        <div class="col-4 text-muted"><strong>Location:</strong></div>
        <div class="col-8">
          {{ image.latitude|floatformat:6 }}, {{ image.longitude|floatformat:6 }}
          <br>
          <small class="text-muted">
            <a href="https://www.google.com/maps?q={{ image.latitude }},{{ image.longitude }}"
               target="_blank" rel="noopener noreferrer">
              View on Google Maps
            </a>
          </small>
        </div>
      </div>
      {% endif %}

      <!-- Tags -->
      {% if image.tags %}
      <div class="row mb-2">
        <div class="col-4 text-muted"><strong>Tags:</strong></div>
        <div class="col-8">
          {% for tag in image.tags %}
            <span class="badge badge-secondary">{{ tag }}</span>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- Image Dimensions -->
      {% if image.web_image %}
      <div class="row mb-2">
        <div class="col-4 text-muted"><strong>Dimensions:</strong></div>
        <div class="col-8">{{ image.web_image.width }} Ã— {{ image.web_image.height }} px</div>
      </div>
      {% endif %}

      <!-- UUID (for reference) -->
      <div class="row mb-0">
        <div class="col-4 text-muted"><strong>Image ID:</strong></div>
        <div class="col-8"><small class="text-monospace">{{ image.uuid }}</small></div>
      </div>
    </div>
  </div>
</div>
{% endtimezone %}
{% endblock %}

{% extends "travelog/pages/base.html" %}
{% load travelog_tags %}
{% load icons %}

{% block head_title %}{{ content.title }} - Table of Contents{% endblock %}

{% block travelog_content %}
<header class="journal-header">
  {% include "travelog/components/travelog_header_nav.html" with show_user_page=True show_image_gallery=True %}
  <div class="text-center">
    <h1 class="journal-title">{{ content.title }}</h1>
    <p class="journal-subtitle">
      {% trip_date_span toc_page.first_day_date toc_page.last_day_date as date_span %}{% if date_span %}{{ date_span }} &bull; {% endif %}{{ toc_page.day_count }} Day{% if toc_page.day_count != 1 %}s{% endif %}
    </p>
    {% if content.description %}
    <p class="journal-description">{{ content.description }}</p>
    {% endif %}
  </div>
</header>

<div class="toc-page-container py-4">
  <div class="container-fluid px-4">
    {% if toc_page.toc_entries %}
    <div class="row">
      {% for toc_entry in toc_page.toc_entries %}
      <div class="col-12 col-sm-6 col-md-4 col-xl-3 mb-4">
        <a href="{% travelog_url 'travelog_day' journal.uuid date=toc_entry.entry.date version=travelog_page.get_version_param %}" class="text-decoration-none">
          <div class="card card-hover h-100{% if toc_entry.entry.is_special_entry %} special{% endif %}">
            {% if toc_entry.entry.reference_image and toc_entry.entry.reference_image.thumbnail_image %}
            <div class="entry-card-image">
              <img src="{{ toc_entry.entry.reference_image.thumbnail_image.url }}" alt="{{ toc_entry.entry.title }}">
            </div>
            {% else %}
            <div class="entry-card-image placeholder">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                <circle cx="8.5" cy="8.5" r="1.5"/>
                <polyline points="21 15 16 10 5 21"/>
              </svg>
            </div>
            {% endif %}
            <div class="card-body">
              <div class="entry-card-day small text-uppercase font-weight-bold mb-1">
                {% if toc_entry.entry.is_special_entry %}
                  {{ toc_entry.entry.page_type.label }}
                {% else %}
                  Day {{ toc_entry.day_number }}
                {% endif %}
              </div>
              {% if toc_entry.entry.is_special_entry %}
                {% if toc_entry.entry.title %}
                <h5 class="card-title mb-0">{{ toc_entry.entry.title }}</h5>
                {% endif %}
              {% else %}
              <h5 class="card-title mb-1">
                {% if toc_entry.entry.title %}{{ toc_entry.entry.title }}{% else %}{{ toc_entry.entry.display_date_nav }}{% endif %}
              </h5>
              <p class="text-muted small mb-0">{{ toc_entry.entry.display_date_nav }}</p>
              {% endif %}
            </div>
          </div>
        </a>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="text-center p-5 bg-light border rounded">
      <div class="col-3 text-muted mb-3 mx-auto">
        {% icon "circle-slash" size="lg" %}
      </div>
      <h3 class="h5">No Journal Entries</h3>
      <p class="text-muted mb-0">This journal doesn't have any entries yet.</p>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}

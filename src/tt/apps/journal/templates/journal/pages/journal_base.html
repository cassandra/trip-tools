{% extends "trips/pages/trips_base.html" %}
{% load static %}
{% load icons %}

{% block sidebar_title %}Trip Journal{% endblock %}

{% block sidebar_back_nav %}
<li>
  <a href="{% url 'trips_home' trip_uuid=trip_page.trip.uuid %}">
    {% icon "chevron-left" size="sm" %}
    <span>Back to Trip</span>
    </a>
</li>
{% endblock %}

{% block sidebar_nav_items %}
{% if journal_page.journal %}

{% if trip_page.request_member.can_edit_trip and not journal_page.has_prologue %}
<li>
  <a href="{% url 'journal_prologue_new' journal_uuid=journal_page.journal.uuid %}" class="text-muted">
    {% icon "plus" size="sm" css_class="tt-icon-left" %}
    <span>Add Prologue</span>
  </a>
</li>
{% endif %}


{% for entry in journal_page.journal_entries %}
<li>
  <a href="{% url 'journal_entry' entry_uuid=entry.uuid %}"
     {% if entry.uuid == journal_page.journal_entry_uuid %}class="active" aria-current="page"{% endif %}>
    {{ entry.display_date_short }}
    {% if not entry.include_in_publish %}
    <small class="text-danger d-block">*</small>
    {% endif %}
  </a>
</li>
{% empty %}
<li><hr><em class="text-primary pl-4">No Journal Entries</em><hr></li>
{% endfor %}

{% if trip_page.request_member.can_edit_trip %}
<li>
  <a href="{% url 'journal_entry_new' journal_uuid=journal_page.journal.uuid %}" class="text-muted">
    {% icon "plus" size="sm" css_class="tt-icon-left" %}
    <span>Add New Day</span>
      </a>
</li>
{% endif %}


{% if trip_page.request_member.can_edit_trip and not journal_page.has_epilogue %}
<li>
  <a href="{% url 'journal_epilogue_new' journal_uuid=journal_page.journal.uuid %}" class="text-muted">
    {% icon "plus" size="sm" css_class="tt-icon-left" %}
    <span>Add Epilogue</span>
  </a>
</li>
{% endif %}

{% if not journal_page.all_entries_included_for_publish %}
<small class="text-danger d-block pl-4 pt-2"><em>* Excluded from publish</em></small>
{% endif %}

{% endif %}
{% endblock %}

{% load icons %}
<div class="journal-editor-container">
  <!-- Formatting Toolbar -->
  <div class="journal-editor-toolbar">
    <!-- Text Formatting Group -->
    <div class="btn-group" role="group" aria-label="Text formatting">
      <button type="button" class="btn btn-sm btn-outline-secondary" data-command="bold" title="Bold (Ctrl+B)">
        {% icon "bold" size="sm" aria_label="Bold" %}
      </button>
      <button type="button" class="btn btn-sm btn-outline-secondary" data-command="italic" title="Italic (Ctrl+I)">
        {% icon "italic" size="sm" aria_label="Italic" %}
      </button>
    </div>

    <div class="toolbar-separator"></div>

    <!-- Headings Dropdown -->
    <div class="btn-group" role="group" aria-label="Headings">
      <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        {% icon "heading" size="sm" aria_label="Heading" %} Heading
      </button>
      <div class="dropdown-menu">
        <a class="dropdown-item" href="#" data-command="heading" data-level="2">Heading 2</a>
        <a class="dropdown-item" href="#" data-command="heading" data-level="3">Heading 3</a>
        <a class="dropdown-item" href="#" data-command="heading" data-level="4">Heading 4</a>
      </div>
    </div>

    <div class="toolbar-separator"></div>

    <!-- Lists Group -->
    <div class="btn-group" role="group" aria-label="Lists">
      <button type="button" class="btn btn-sm btn-outline-secondary" data-command="insertUnorderedList" title="Bulleted list">
        {% icon "list-ul" size="sm" aria_label="Bulleted list" %}
      </button>
      <button type="button" class="btn btn-sm btn-outline-secondary" data-command="insertOrderedList" title="Numbered list">
        {% icon "list-ol" size="sm" aria_label="Numbered list" %}
      </button>
    </div>
  </div>

  <!-- ContentEditable Editor -->
  <div
    class="{{ DIVID.JOURNAL_EDITOR_CLASS }}"
    id="{{ DIVID.JOURNAL_EDITOR_ID }}"
    contenteditable="true"
    data-{{ DIVID.JOURNAL_ENTRY_PK_ATTR }}="{{ entry.pk }}"
    data-{{ DIVID.JOURNAL_CURRENT_VERSION_ATTR }}="{{ entry.edit_version }}"
    data-{{ DIVID.JOURNAL_AUTOSAVE_URL_ATTR }}="{% url 'journal_entry_autosave' trip_id=trip.id entry_pk=entry.pk %}"
    data-placeholder="Start writing your journal entry..."
    role="textbox"
    aria-label="Journal entry content"
    aria-multiline="true"
  >{{ entry.text|safe }}</div>

  <!-- Mobile Warning (shown below 768px) -->
  <div class="journal-editor-mobile-warning d-md-none">
    <div class="alert alert-warning mb-0">
      <strong>Desktop Mode Recommended</strong>
      <p class="mb-0 small">For the best editing experience with image management, please use a larger screen (768px or wider).</p>
    </div>
  </div>

  <!-- Hidden textarea for form fallback (non-JS) -->
  <textarea class="d-none" name="text" id="{{ DIVID.JOURNAL_EDITOR_ID }}_fallback">{{ entry.text }}</textarea>

  <!-- Editing Help Button -->
  <div class="d-flex justify-content-end mt-2">
    <a href="{% url 'journal_editor_help' %}"
       class="btn btn-sm btn-outline-secondary"
       data-async="modal"
       title="Show keyboard shortcuts and editing help">
      {% load icons %}
      {% icon "question-circle" size="sm" %} Editing Help
    </a>
  </div>
</div>

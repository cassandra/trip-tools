{% load static %}
{% load icons %}

<!-- Panel Header - Fixed -->
<div class="{{ TtConst.JOURNAL_EDITOR_MULTI_IMAGE_PANEL_HEADER_CLASS }}">
  <div class="d-flex justify-content-between align-items-center mb-2">
    <h5 class="mb-0">Images</h5>
    <a href="{% url 'journal_editor_multi_image_upload' entry_uuid=entry.uuid %}"
       class="btn btn-sm btn-outline-primary"
       data-async="modal">
      {% icon "upload" size="sm" css_class="tt-icon-left" %}
      Upload
    </a>
  </div>

  <!-- Date and Scope Filter Form -->
  <form method="get" action="{% url 'journal_editor_multi_images' entry_uuid=entry.uuid %}" data-async="#{{ TtConst.JOURNAL_EDITOR_MULTI_IMAGE_GALLERY_ID }}" data-mode="insert" id="{{ TtConst.JOURNAL_EDITOR_MULTI_IMAGE_FILTER_FORM_ID }}">
    <!-- Date Filter with Entry Date and Recent Buttons -->
    <div class="d-flex mb-2">
      <input
          type="date"
          class="form-control form-control-sm"
          id="{{ TtConst.JOURNAL_EDITOR_MULTI_IMAGE_DATE_INPUT_ID }}"
          name="date"
          {% if not is_recent_mode %}value="{{ entry.date|date:'Y-m-d' }}"{% endif %}
      >
      <button
          type="button"
          id="{{ TtConst.JOURNAL_EDITOR_MULTI_IMAGE_ENTRY_DATE_BTN_ID }}"
          class="btn btn-sm {% if filter_date %}btn-primary{% else %}btn-outline-primary{% endif %} ml-1 flex-shrink-0"
          title="{% if filter_date %}Show images from {{ filter_date|date:'M j, Y' }}{% else %}Select a date first{% endif %}"
          data-last-used-date="{% if filter_date %}{{ filter_date|date:'Y-m-d' }}{% endif %}"
          {% if not filter_date %}disabled{% endif %}>
        {% if filter_date %}{{ filter_date|date:"M j" }}{% else %}Date{% endif %}
      </button>
      <button
          type="button"
          class="btn btn-sm {% if is_recent_mode %}btn-primary{% else %}btn-outline-primary{% endif %} ml-1 flex-shrink-0"
          id="{{ TtConst.JOURNAL_EDITOR_MULTI_IMAGE_RECENT_BTN_ID }}"
          title="Show recently uploaded images">
        Recent
      </button>
    </div>

    <!-- Scope Filter Pills (client-side filtering only) -->
    <div class="btn-group btn-group-sm btn-group-toggle w-100" data-toggle="buttons">
      <label class="btn btn-outline-secondary active">
        <input type="radio" name="scope" value="unused" checked> Unused
      </label>
      <label class="btn btn-outline-secondary">
        <input type="radio" name="scope" value="used"> Used
      </label>
      <label class="btn btn-outline-secondary">
        <input type="radio" name="scope" value="all"> All
      </label>
    </div>
  </form>
</div>

<!-- Image Gallery Grid - Scrollable -->
<div class="{{ TtConst.JOURNAL_EDITOR_MULTI_IMAGE_GALLERY_CLASS }} row" id="{{ TtConst.JOURNAL_EDITOR_MULTI_IMAGE_GALLERY_ID }}">
  {% include "journal/components/journal_editor_multi_image_gallery_grid.html" with accessible_images=accessible_images trip=trip %}
</div>

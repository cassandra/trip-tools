{% extends "pages/secondary-page-sidebar.html" %}
{% load static %}
{% load icons %}

{% block main_extra_actions %}
<div class="dropdown mr-2">
  <button class="btn btn-outline-light dropdown-toggle" type="button" id="newDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    + New
  </button>
  <div class="dropdown-menu dropdown-menu-right" aria-labelledby="newDropdown">
    {% if trip_page.request_member.can_edit_trip %}
    <a class="dropdown-item" href="#">New Location</a>
    <a class="dropdown-item" href="#">New Booking</a>
    <a class="dropdown-item" href="#">New Review</a>
    <div class="dropdown-divider"></div>
    {% endif %}
    <a class="dropdown-item" href="{% url 'trips_create' %}" data-async="modal">New Trip</a>
  </div>
</div>
{% endblock %}

{% block sidebar_content %}
<ul class="app-sidebar-nav">
  <li>
    <a href="{% url 'dashboard_home' %}">
      {% icon "chevron-left" size="sm" %}
      <span>Back to Dashboard</span>
    </a>
  </li>
  <li>
    <a href="{% url 'trips_home' trip_uuid=trip_page.trip.uuid %}"{% if trip_page.active_page.value == 'trip_overview' %} class="active" aria-current="page"{% endif %}>
      {% icon "home" size="sm" %}
      <span>Trip Overview</span>
    </a>
  </li>
  <li>
    <a href="{% url 'itineraries_home' trip_uuid=trip_page.trip.uuid %}"{% if trip_page.active_page.value == 'itinerary' %} class="active" aria-current="page"{% endif %}>
      {% icon "clock" size="sm" %}
      <span>Itinerary</span>
    </a>
  </li>
  <li>
    <a href="#"{% if trip_page.active_page.value == 'locations' %} class="active" aria-current="page"{% endif %}>
      {% icon "map-pin" size="sm" %}
      <span>Locations</span>
    </a>
  </li>
  <li>
    <a href="#"{% if trip_page.active_page.value == 'bookings' %} class="active" aria-current="page"{% endif %}>
      {% icon "layers" size="sm" %}
      <span>Bookings</span>
    </a>
  </li>
  <li>
    <a href="{% url 'journal_home' trip_uuid=trip_page.trip.uuid %}"{% if trip_page.active_page.value == 'journal' %} class="active" aria-current="page"{% endif %}>
      {% icon "collection" size="sm" %}
      <span>Journal</span>
    </a>
  </li>
  <li>
    <a href="#"{% if trip_page.active_page.value == 'reviews' %} class="active" aria-current="page"{% endif %}>
      {% icon "edit" size="sm" %}
      <span>Reviews</span>
    </a>
  </li>
  <li>
    <a href="{% url 'members_list' trip_uuid=trip_page.trip.uuid %}"{% if trip_page.active_page.value == 'members' %} class="active" aria-current="page"{% endif %}>
      {% icon "collection" size="sm" %}
      <span>Members</span>
    </a>
  </li>
</ul>
{% endblock %}

{% block secondary_content %}
<div class="secondary-page-header">
  <div class="d-flex justify-content-between align-items-center mb-2">
    <div class="d-flex align-items-center">
      {# Trip reference image - fixed square #}
      <div class="ml-2 mr-2" style="width: 3rem; height: 3rem; flex-shrink: 0;">
        {% url 'trip_reference_image_picker' trip_uuid=trip_page.trip.uuid as trip_image_picker_url %}
        {% include "images/components/reference_image_display.html" with image=trip_page.trip.reference_image height="3rem" show_edit_icon=trip_page.request_member.can_edit_trip edit_url=trip_image_picker_url placeholder_icon="map-pin" %}
      </div>

      <h1 class="h2 mb-0 mx-2">{{ trip_page.trip.title }}</h1>
      {% if trip_page.request_member.can_edit_trip %}
      <a href="{% url 'trips_edit' trip_uuid=trip_page.trip.uuid %}"
         data-async="modal"
         class="text-muted mr-2"
         title="Edit trip title and description">
        {% icon "edit" size="lg" %}
      </a>
      {% endif %}
      <span class="badge badge-info">{{ trip_page.trip.trip_status.label }}</span>
    </div>
    {% block trip_extra_actions %}
    {% endblock %}
  </div>
</div>

<div class="secondary-page-content">
  {% block trip_content %}
  {% endblock %}
</div>

{% endblock %}

{% extends "pages/secondary-page-sidebar.html" %}
{% load static %}
{% load icons %}

{% block main_extra_actions %}
<div class="dropdown mr-2">
  <button class="btn btn-outline-light dropdown-toggle" type="button" id="newDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    + New
  </button>
  <div class="dropdown-menu dropdown-menu-right" aria-labelledby="newDropdown">
    <a class="dropdown-item" href="#">New Location</a>
    <a class="dropdown-item" href="#">New Booking</a>
    <a class="dropdown-item" href="{% url 'notebook_new' trip_id=sidebar.trip.pk %}">New Note</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="{% url 'trips_create' %}" data-async="modal">New Trip</a>
  </div>
</div>
{% endblock %}

{% block sidebar_content %}
<ul class="app-sidebar-nav">
  <li>
    <a href="{% url 'trips_home' trip_id=sidebar.trip.pk %}"{% if sidebar.active_page.value == 'trip_overview' %} class="active" aria-current="page"{% endif %}>
      {% icon "home" size="sm" %}
      <span>Trip Overview</span>
    </a>
  </li>
  <li>
    <a href="{% url 'itineraries_home' trip_pk=sidebar.trip.pk %}"{% if sidebar.active_page.value == 'itinerary' %} class="active" aria-current="page"{% endif %}>
      {% icon "clock" size="sm" %}
      <span>Itinerary</span>
    </a>
  </li>
  <li>
    <a href="#"{% if sidebar.active_page.value == 'locations' %} class="active" aria-current="page"{% endif %}>
      {% icon "map-pin" size="sm" %}
      <span>Locations</span>
    </a>
  </li>
  <li>
    <a href="#"{% if sidebar.active_page.value == 'bookings' %} class="active" aria-current="page"{% endif %}>
      {% icon "layers" size="sm" %}
      <span>Bookings</span>
    </a>
  </li>
  <li>
    <a href="{% url 'notebook_list' trip_id=sidebar.trip.pk %}"{% if sidebar.active_page.value == 'notes' %} class="active" aria-current="page"{% endif %}>
      {% icon "edit" size="sm" %}
      <span>Notes</span>
    </a>
    {% if sidebar.active_page.value == 'notes' and sidebar.notebook_entries %}
    <ul class="app-sidebar-nav-nested">
      {% for entry in sidebar.notebook_entries %}
      <li>
        <a href="{% url 'notebook_edit' trip_id=sidebar.trip.pk entry_pk=entry.pk %}"{% if entry.pk == sidebar.current_entry_pk %} class="active" aria-current="page"{% endif %}>
          {{ entry.date|date:'M j' }}
        </a>
      </li>
      {% endfor %}
      <li>
        <a href="{% url 'notebook_new' trip_id=sidebar.trip.pk %}" class="text-muted">
          {% icon "plus" size="sm" css_class="tt-icon-left" %}
          <span>New Note</span>
        </a>
      </li>
    </ul>
    {% endif %}
  </li>
</ul>
{% endblock %}

{% block secondary_content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h1 class="h2 mb-1">{{ sidebar.trip.title }}</h1>
    <span class="badge badge-info">{{ sidebar.trip.trip_status.label }}</span>
  </div>
  {% block trip_extra_actions %}
  {% endblock %}
</div>

{% block trip_content %}
{% endblock %}

{% endblock %}
